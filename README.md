Задание 1. Напишите SQL-запрос, который выводит всю информацию о фильмах со специальным атрибутом “Behind the Scenes”.
Ожидаемый результат запроса: letsdocode.ru...in/6-1.png

Задание 2. Напишите ещё 2 варианта поиска фильмов с атрибутом “Behind the Scenes”, используя другие функции или операторы языка SQL для поиска значения в массиве.
Ожидаемый результат запроса: letsdocode.ru...in/6-2.png

Задание 3. Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в CTE.
Ожидаемый результат запроса: letsdocode.ru...in/6-3.png

Задание 4. Для каждого покупателя посчитайте, сколько он брал в аренду фильмов со специальным атрибутом “Behind the Scenes”.
Обязательное условие для выполнения задания: используйте запрос из задания 1, помещённый в подзапрос, который необходимо использовать для решения задания.
Ожидаемый результат запроса: letsdocode.ru...in/6-4.png

Задание 5. Создайте материализованное представление с запросом из предыдущего задания и напишите запрос для обновления материализованного представления.

Задание 6. С помощью explain analyze проведите анализ стоимости выполнения запросов из предыдущих заданий и ответьте на вопросы:

С каким оператором или функцией языка SQL, используемыми при выполнении домашнего задания, поиск значения в массиве затрачивает меньше ресурсов системы;
Какой вариант вычислений затрачивает меньше ресурсов системы: с использованием CTE или с использованием подзапроса.
Дополнительная часть:

Задание 1. Откройте по ссылке SQL-запрос.

Сделайте explain analyze этого запроса.
Основываясь на описании запроса, найдите узкие места и опишите их.
Сравните с вашим запросом из основной части (если ваш запрос изначально укладывается в 15мс — отлично!).
Сделайте построчное описание explain analyze на русском языке оптимизированного запроса. Описание строк в explain можно посмотреть по ссылке.
Задание 2. Используя оконную функцию, выведите для каждого сотрудника сведения о первой его продаже.
Ожидаемый результат запроса: letsdocode.ru...in/6-5.png

Задание 3. Для каждого магазина определите и выведите одним SQL-запросом следующие аналитические показатели:

день, в который арендовали больше всего фильмов (в формате год-месяц-день);
количество фильмов, взятых в аренду в этот день;
день, в который продали фильмов на наименьшую сумму (в формате год-месяц-день);
сумму продажи в этот день.
Ожидаемый результат запроса: letsdocode.ru...in/6-6.png
Результат домашнего задания
